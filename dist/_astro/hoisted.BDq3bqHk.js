const A=[{name:"AWS Access Key ID",regex:/(?:^|['"= ])?(AKIA[0-9A-Z]{16})(?:['"\s]|$)/,severity:"critical",desc:"AWS access key detected",fix:"Rotate this key immediately in AWS IAM console and use environment-specific credentials."},{name:"AWS Secret Access Key",regex:/(?:aws_secret_access_key|aws_secret)\s*=\s*['"]?([A-Za-z0-9/+=]{40})['"]?/,severity:"critical",desc:"AWS secret key detected",fix:"Rotate in AWS IAM. Use IAM roles or AWS Secrets Manager instead."},{name:"Stripe Secret Key",regex:/sk_live_[0-9a-zA-Z]{24,}/,severity:"critical",desc:"Stripe live secret key detected",fix:"Rotate in Stripe Dashboard â†’ API Keys. Use restricted keys with minimal permissions."},{name:"Stripe Publishable Key",regex:/pk_live_[0-9a-zA-Z]{24,}/,severity:"info",desc:"Stripe publishable key (safe for client-side, but keep out of repos)",fix:"Publishable keys are designed for client use but should still be in env vars."},{name:"GitHub Personal Access Token",regex:/ghp_[0-9a-zA-Z]{36}/,severity:"critical",desc:"GitHub PAT detected",fix:"Revoke at GitHub Settings â†’ Developer Settings â†’ Personal Access Tokens."},{name:"GitHub OAuth Token",regex:/gho_[0-9a-zA-Z]{36}/,severity:"critical",desc:"GitHub OAuth token detected",fix:"Revoke at GitHub Settings â†’ Applications."},{name:"GitHub App Token",regex:/(?:ghu|ghs)_[0-9a-zA-Z]{36}/,severity:"critical",desc:"GitHub App token detected",fix:"Rotate via your GitHub App settings."},{name:"GitHub Fine-grained PAT",regex:/github_pat_[0-9a-zA-Z_]{82}/,severity:"critical",desc:"GitHub fine-grained PAT detected",fix:"Revoke at GitHub Settings â†’ Developer Settings."},{name:"OpenAI API Key",regex:/sk-[0-9a-zA-Z]{20}T3BlbkFJ[0-9a-zA-Z]{20}/,severity:"critical",desc:"OpenAI API key detected",fix:"Rotate at platform.openai.com/api-keys. Set usage limits."},{name:"OpenAI API Key (new format)",regex:/sk-proj-[0-9a-zA-Z_-]{40,}/,severity:"critical",desc:"OpenAI project API key detected",fix:"Rotate at platform.openai.com/api-keys."},{name:"Google API Key",regex:/AIza[0-9A-Za-z_-]{35}/,severity:"critical",desc:"Google API key detected",fix:"Restrict key in Google Cloud Console â†’ APIs & Services â†’ Credentials."},{name:"Google OAuth Client Secret",regex:/GOCSPX-[0-9A-Za-z_-]{28}/,severity:"critical",desc:"Google OAuth client secret detected",fix:"Rotate in Google Cloud Console â†’ OAuth 2.0 Client IDs."},{name:"Slack Bot Token",regex:/xoxb-[0-9]{10,13}-[0-9]{10,13}-[0-9a-zA-Z]{24}/,severity:"critical",desc:"Slack bot token detected",fix:"Rotate at api.slack.com â†’ Your Apps â†’ OAuth & Permissions."},{name:"Slack User Token",regex:/xoxp-[0-9]{10,13}-[0-9]{10,13}-[0-9a-zA-Z]{24,}/,severity:"critical",desc:"Slack user token detected",fix:"Rotate at api.slack.com â†’ Your Apps â†’ OAuth & Permissions."},{name:"Slack Webhook URL",regex:/hooks\.slack\.com\/services\/T[0-9A-Z]{8,}\/B[0-9A-Z]{8,}\/[0-9a-zA-Z]{24}/,severity:"warning",desc:"Slack webhook URL detected",fix:"Rotate the webhook in your Slack app settings."},{name:"Twilio Account SID",regex:/AC[0-9a-f]{32}/,severity:"warning",desc:"Twilio Account SID detected",fix:"SIDs are semi-public but should still be in env vars."},{name:"Twilio Auth Token",regex:/(?:twilio.*auth.*token|TWILIO_AUTH_TOKEN)\s*=\s*['"]?([0-9a-f]{32})['"]?/i,severity:"critical",desc:"Twilio auth token detected",fix:"Rotate in Twilio Console â†’ Account â†’ API Keys."},{name:"SendGrid API Key",regex:/SG\.[0-9A-Za-z_-]{22}\.[0-9A-Za-z_-]{43}/,severity:"critical",desc:"SendGrid API key detected",fix:"Rotate at app.sendgrid.com â†’ Settings â†’ API Keys."},{name:"Mailgun API Key",regex:/key-[0-9a-zA-Z]{32}/,severity:"critical",desc:"Mailgun API key detected",fix:"Rotate in Mailgun Dashboard â†’ API Security."},{name:"Datadog API Key",regex:/(?:datadog|dd)[\w_]*(?:api)?[\w_]*key\s*=\s*['"]?([0-9a-f]{32})['"]?/i,severity:"critical",desc:"Datadog API key detected",fix:"Rotate in Datadog â†’ Organization Settings â†’ API Keys."},{name:"New Relic API Key",regex:/NRAK-[0-9A-Z]{27}/,severity:"critical",desc:"New Relic API key detected",fix:"Rotate at one.newrelic.com â†’ API Keys."},{name:"New Relic License Key",regex:/[0-9a-f]{36}NRAL/,severity:"critical",desc:"New Relic license key detected",fix:"Rotate in New Relic account settings."},{name:"PagerDuty API Key",regex:/(?:pagerduty|pd)[\w_]*key\s*=\s*['"]?([0-9a-zA-Z+/=]{20,})['"]?/i,severity:"critical",desc:"PagerDuty key detected",fix:"Rotate at PagerDuty â†’ API Access Keys."},{name:"Sentry DSN",regex:/https:\/\/[0-9a-f]{32}@(?:o\d+\.)?(?:sentry\.io|[^/]+)\/\d+/,severity:"warning",desc:"Sentry DSN detected (contains project info)",fix:"DSNs are semi-public for client SDKs but should not be committed."},{name:"Firebase API Key",regex:/(?:firebase|FIREBASE)[\w_]*(?:api)?[\w_]*key\s*=\s*['"]?(AIza[0-9A-Za-z_-]{35})['"]?/i,severity:"warning",desc:"Firebase API key detected",fix:"Restrict via Firebase Console â†’ Project Settings â†’ API restrictions."},{name:"Supabase Service Role Key",regex:/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\.[A-Za-z0-9_-]{50,}\.[A-Za-z0-9_-]{20,}/,severity:"critical",desc:"Supabase/JWT service key detected",fix:"Rotate in Supabase Dashboard â†’ Settings â†’ API."},{name:"Cloudflare API Token",regex:/(?:cloudflare|cf)[\w_]*(?:api)?[\w_]*token\s*=\s*['"]?([0-9a-zA-Z_-]{40})['"]?/i,severity:"critical",desc:"Cloudflare API token detected",fix:"Rotate at Cloudflare Dashboard â†’ My Profile â†’ API Tokens."},{name:"Cloudflare Global API Key",regex:/(?:cloudflare|cf)[\w_]*(?:global)?[\w_]*key\s*=\s*['"]?([0-9a-f]{37})['"]?/i,severity:"critical",desc:"Cloudflare Global API key detected",fix:"Use scoped API tokens instead. Rotate in Cloudflare profile."},{name:"DigitalOcean Token",regex:/dop_v1_[0-9a-f]{64}/,severity:"critical",desc:"DigitalOcean personal access token detected",fix:"Revoke at cloud.digitalocean.com â†’ API â†’ Tokens."},{name:"DigitalOcean OAuth",regex:/doo_v1_[0-9a-f]{64}/,severity:"critical",desc:"DigitalOcean OAuth token detected",fix:"Revoke at cloud.digitalocean.com â†’ API."},{name:"Heroku API Key",regex:/(?:heroku[\w_]*(?:api)?[\w_]*key)\s*=\s*['"]?([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})['"]?/i,severity:"critical",desc:"Heroku API key detected",fix:"Regenerate at Heroku Dashboard â†’ Account â†’ API Key."},{name:"Vercel Token",regex:/(?:vercel[\w_]*token)\s*=\s*['"]?([0-9a-zA-Z]{24,})['"]?/i,severity:"critical",desc:"Vercel token detected",fix:"Rotate at vercel.com â†’ Settings â†’ Tokens."},{name:"Netlify Token",regex:/(?:netlify[\w_]*token)\s*=\s*['"]?([0-9a-zA-Z_-]{40,})['"]?/i,severity:"critical",desc:"Netlify token detected",fix:"Rotate at app.netlify.com â†’ User Settings â†’ Applications."},{name:"npm Token",regex:/npm_[0-9a-zA-Z]{36}/,severity:"critical",desc:"npm access token detected",fix:"Revoke at npmjs.com â†’ Access Tokens. Use granular tokens."},{name:"PyPI Token",regex:/pypi-[0-9a-zA-Z_-]{50,}/,severity:"critical",desc:"PyPI API token detected",fix:"Revoke at pypi.org â†’ Account Settings â†’ API Tokens."},{name:"Docker Hub Token",regex:/dckr_pat_[0-9a-zA-Z_-]{20,}/,severity:"critical",desc:"Docker Hub personal access token detected",fix:"Revoke at hub.docker.com â†’ Account Settings â†’ Security."},{name:"CircleCI Token",regex:/(?:circleci|circle)[\w_]*token\s*=\s*['"]?([0-9a-f]{40})['"]?/i,severity:"critical",desc:"CircleCI token detected",fix:"Rotate at circleci.com â†’ User Settings â†’ Personal API Tokens."},{name:"Travis CI Token",regex:/(?:travis[\w_]*token)\s*=\s*['"]?([0-9a-zA-Z]{22,})['"]?/i,severity:"critical",desc:"Travis CI token detected",fix:"Rotate in Travis CI account settings."},{name:"GitLab Token",regex:/glpat-[0-9a-zA-Z_-]{20}/,severity:"critical",desc:"GitLab personal access token detected",fix:"Revoke at GitLab â†’ User Settings â†’ Access Tokens."},{name:"GitLab Pipeline Token",regex:/glptt-[0-9a-f]{40}/,severity:"critical",desc:"GitLab pipeline trigger token detected",fix:"Revoke in GitLab â†’ CI/CD â†’ Pipeline triggers."},{name:"Bitbucket App Password",regex:/(?:bitbucket[\w_]*(?:app)?[\w_]*(?:pass|pw))\s*=\s*['"]?([0-9a-zA-Z]{18,})['"]?/i,severity:"critical",desc:"Bitbucket app password detected",fix:"Revoke at Bitbucket â†’ Personal Settings â†’ App Passwords."},{name:"Azure Storage Key",regex:/(?:DefaultEndpointsProtocol=https;AccountName=)[^;]+;AccountKey=[A-Za-z0-9+/=]{86,88};/,severity:"critical",desc:"Azure Storage connection string detected",fix:"Rotate in Azure Portal â†’ Storage Account â†’ Access Keys."},{name:"Azure Client Secret",regex:/(?:azure[\w_]*(?:client)?[\w_]*secret)\s*=\s*['"]?([0-9a-zA-Z~._-]{34,})['"]?/i,severity:"critical",desc:"Azure client secret detected",fix:"Rotate in Azure AD â†’ App Registrations â†’ Certificates & Secrets."},{name:"GCP Service Account Key",regex:/"private_key":\s*"-----BEGIN (?:RSA )?PRIVATE KEY-----/,severity:"critical",desc:"GCP service account private key detected",fix:"Delete and recreate at GCP Console â†’ IAM â†’ Service Accounts â†’ Keys."},{name:"GCP API Key",regex:/(?:gcp|google_cloud)[\w_]*(?:api)?[\w_]*key\s*=\s*['"]?(AIza[0-9A-Za-z_-]{35})['"]?/i,severity:"critical",desc:"GCP API key detected",fix:"Restrict in GCP Console â†’ APIs & Services â†’ Credentials."},{name:"Private Key (PEM)",regex:/-----BEGIN (?:RSA |EC |DSA |OPENSSH )?PRIVATE KEY-----/,severity:"critical",desc:"Private key detected in env file",fix:"Never store private keys in .env files. Use a secrets manager or key vault."},{name:"JWT Secret",regex:/(?:jwt[\w_]*secret|secret[\w_]*key)\s*=\s*['"]?([^\s'"]{8,})['"]?/i,severity:"warning",desc:"JWT secret or signing key detected",fix:"Use a strong, random secret (256+ bits). Store in a secrets manager."},{name:"Database URL with Password",regex:/(?:postgres(?:ql)?|mysql|mariadb|mssql):\/\/[^:]+:[^@\s]+@[^\s]+/,severity:"critical",desc:"Database connection string with embedded password",fix:"Use separate DB_HOST/DB_PASSWORD vars or a secrets manager."},{name:"Redis URL with Password",regex:/rediss?:\/\/[^:]*:[^@\s]+@[^\s]+/,severity:"critical",desc:"Redis URL with embedded password",fix:"Use separate REDIS_HOST/REDIS_PASSWORD environment variables."},{name:"MongoDB URI with Password",regex:/mongodb(?:\+srv)?:\/\/[^:]+:[^@\s]+@[^\s]+/,severity:"critical",desc:"MongoDB connection string with embedded password",fix:"Use MongoDB Atlas secrets or separate DB credential vars."},{name:"Shopify Access Token",regex:/shpat_[0-9a-fA-F]{32}/,severity:"critical",desc:"Shopify admin access token detected",fix:"Rotate in Shopify Admin â†’ Apps â†’ Develop apps."},{name:"Shopify Shared Secret",regex:/shpss_[0-9a-fA-F]{32}/,severity:"critical",desc:"Shopify shared secret detected",fix:"Rotate in Shopify Partner Dashboard."},{name:"Discord Bot Token",regex:/[MN][A-Za-z\d]{23,}\.[\w-]{6}\.[\w-]{27,}/,severity:"critical",desc:"Discord bot token detected",fix:"Regenerate at discord.com/developers â†’ Bot â†’ Reset Token."},{name:"Telegram Bot Token",regex:/\d{8,10}:[0-9A-Za-z_-]{35}/,severity:"critical",desc:"Telegram bot token detected",fix:"Revoke via @BotFather on Telegram."},{name:"Anthropic API Key",regex:/sk-ant-api\d{2}-[0-9a-zA-Z_-]{90,}/,severity:"critical",desc:"Anthropic API key detected",fix:"Rotate at console.anthropic.com â†’ API Keys."},{name:"Hugging Face Token",regex:/hf_[0-9a-zA-Z]{34}/,severity:"critical",desc:"Hugging Face access token detected",fix:"Rotate at huggingface.co â†’ Settings â†’ Access Tokens."},{name:"Mapbox Token",regex:/(?:pk|sk)\.eyJ[0-9a-zA-Z_-]+\.[0-9a-zA-Z_-]{20,}/,severity:"warning",desc:"Mapbox access token detected",fix:"Rotate at mapbox.com â†’ Account â†’ Tokens. Restrict token scopes."},{name:"Algolia API Key",regex:/(?:algolia[\w_]*(?:api)?[\w_]*key)\s*=\s*['"]?([0-9a-f]{32})['"]?/i,severity:"warning",desc:"Algolia API key detected",fix:"Use search-only keys for client-side. Rotate admin keys in Algolia Dashboard."},{name:"Mixpanel Token",regex:/(?:mixpanel[\w_]*token)\s*=\s*['"]?([0-9a-f]{32})['"]?/i,severity:"warning",desc:"Mixpanel project token detected",fix:"Tokens are semi-public but should not be committed."},{name:"Segment Write Key",regex:/(?:segment[\w_]*(?:write)?[\w_]*key)\s*=\s*['"]?([0-9a-zA-Z]{22,})['"]?/i,severity:"warning",desc:"Segment write key detected",fix:"Rotate in Segment â†’ Workspace â†’ Sources â†’ Settings."},{name:"Linear API Key",regex:/lin_api_[0-9a-zA-Z]{40}/,severity:"critical",desc:"Linear API key detected",fix:"Revoke at linear.app â†’ Settings â†’ API."},{name:"Livekit API Key/Secret",regex:/(?:livekit[\w_]*(?:api)?[\w_]*(?:key|secret))\s*=\s*['"]?([0-9a-zA-Z]{20,})['"]?/i,severity:"critical",desc:"LiveKit credential detected",fix:"Rotate in your LiveKit Cloud dashboard."},{name:"Postmark Server Token",regex:/(?:postmark[\w_]*(?:server)?[\w_]*token)\s*=\s*['"]?([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})['"]?/i,severity:"critical",desc:"Postmark server token detected",fix:"Rotate in Postmark â†’ Servers â†’ API Tokens."},{name:"Resend API Key",regex:/re_[0-9a-zA-Z]{20,}/,severity:"critical",desc:"Resend API key detected",fix:"Rotate at resend.com â†’ API Keys."},{name:"Planetscale Password",regex:/pscale_pw_[0-9a-zA-Z_-]{40,}/,severity:"critical",desc:"PlanetScale database password detected",fix:"Rotate in PlanetScale Dashboard â†’ Database â†’ Passwords."},{name:"Turso Database Token",regex:/(?:turso|libsql)[\w_]*(?:auth)?[\w_]*token\s*=\s*['"]?(eyJ[0-9a-zA-Z_-]+\.[0-9a-zA-Z_-]+\.[0-9a-zA-Z_-]+)['"]?/i,severity:"critical",desc:"Turso/LibSQL auth token detected",fix:"Rotate via turso CLI: turso db tokens invalidate."},{name:"Clerk Secret Key",regex:/sk_live_[0-9a-zA-Z]{20,}/,severity:"critical",desc:"Clerk secret key detected",fix:"Rotate in Clerk Dashboard â†’ API Keys."},{name:"Generic Secret in Value",regex:/(?:secret|password|passwd|token|apikey|api_key|auth_token|access_token)[\w]*\s*=\s*['"]?([^\s'"]{8,})['"]?/i,severity:"warning",desc:"Potential secret value detected",fix:"Review this value and ensure it is not committed to version control."}],I=["password","password1","password123","123456","12345678","123456789","1234567890","admin","admin123","root","root123","test","test123","changeme","changeit","default","secret","letmein","welcome","qwerty","abc123","monkey","master","dragon","login","princess","football","shadow","sunshine","trustno1","iloveyou","batman","passw0rd","hello","charlie","donald","p@ssw0rd","P@ssw0rd","P@ssword1","supersecret","hunter2","letmein123"],v=`# Database
DATABASE_URL=postgres://admin:password123@localhost:5432/myapp
REDIS_URL=redis://:supersecret@cache.example.com:6379

# AWS
AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
AWS_REGION=us-east-1

# Stripe
STRIPE_SECRET_KEY=sk_live_51HG8eXAMPLEKEYabc123def456
STRIPE_PUBLISHABLE_KEY=pk_live_51HG8eXAMPLEKEYxyz789

# OpenAI
OPENAI_API_KEY=sk-proj-abc123def456ghi789jkl012mno345pqr678stu901vwx

# GitHub
GITHUB_TOKEN=ghp_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefgh

# Slack
SLACK_BOT_TOKEN=xoxb-1234567890-1234567890123-ABCDEFGHIJKLMNOPQRSTUVw

# SendGrid
SENDGRID_API_KEY=SG.abcdefghijklmnopqrstuv.ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopq

# App Config
APP_NAME=My Cool App
DEBUG=true
PORT=3000
NODE_ENV=development
API_URL=https://api.example.com
JWT_SECRET=changeme

# Duplicate key
DEBUG=false

# Empty values
EMPTY_VAR=
ANOTHER_EMPTY=

# Unquoted value with spaces
APP_DESCRIPTION=My awesome app with spaces

# Commented out secret
# OLD_API_KEY=sk_live_oldkey123456789012345678
# PREVIOUS_DB_PASSWORD=oldpassword123

# npm
NPM_TOKEN=npm_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefgh

# GitLab
GITLAB_TOKEN=glpat-ABCDEFGHIJKLMNOPabcd

# Private key (BAD!)
PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----\\nMIIEpA..."
`;function y(t){if(!t.trim())return null;const r=t.split(`
`),i=[],e={};let s=0;for(const g of r){s++;const o=g.trim();if(!o)continue;if(o.startsWith("#")){const d=o.slice(1).trim();for(const u of A)if(u.regex.test(d)){i.push({line:s,severity:"warning",name:`Commented-out ${u.name}`,desc:`Commented line still contains a ${u.name.toLowerCase()}. Remove it entirely.`,fix:"Delete commented-out secrets completely rather than just commenting them."});break}continue}const a=o.match(/^([^=]+?)=(.*)$/);if(!a)continue;const[,l,b]=a,n=l.trim(),c=b.trim();if(/^[A-Za-z_][A-Za-z0-9_]*$/.test(n)||i.push({line:s,severity:"warning",name:"Invalid key name",desc:`"${n}" contains invalid characters. Keys should be alphanumeric with underscores.`,fix:"Use only A-Z, 0-9, and underscore. Start with a letter or underscore."}),e[n]&&i.push({line:s,severity:"warning",name:"Duplicate key",desc:`"${n}" is defined on lines ${e[n]} and ${s}. The last value wins.`,fix:"Remove the duplicate definition to avoid confusion."}),e[n]=s,c===""){i.push({line:s,severity:"info",name:"Empty value",desc:`"${n}" has an empty value.`,fix:"Set a value or remove the variable if unused."});continue}c.includes(" ")&&!c.startsWith('"')&&!c.startsWith("'")&&i.push({line:s,severity:"warning",name:"Unquoted value with spaces",desc:`"${n}" contains spaces but is not quoted. Some parsers may truncate at the first space.`,fix:'Wrap the value in double quotes: KEY="value with spaces"'}),(c.startsWith('"')&&c.includes('\\"')===!1&&(c.match(/"/g)||[]).length%2!==0||c.startsWith("'")&&(c.match(/'/g)||[]).length%2!==0)&&i.push({line:s,severity:"warning",name:"Mismatched quotes",desc:`"${n}" has mismatched quotes.`,fix:"Ensure opening and closing quotes match."});const p=c.replace(/^['"]|['"]$/g,"").toLowerCase();/(?:password|passwd|pass|secret|key|token)/i.test(n)&&I.includes(p)&&i.push({line:s,severity:"critical",name:"Weak/default password",desc:`"${n}" uses a common weak password: "${p}".`,fix:"Use a strong, randomly generated password (32+ characters, mixed case, numbers, symbols)."});for(const d of A)d.regex.test(o)&&i.push({line:s,severity:d.severity,name:d.name,desc:d.desc,fix:d.fix})}return i}function x(t){const r=t.filter(s=>s.severity==="critical").length,i=t.filter(s=>s.severity==="warning").length,e=Math.max(0,100-r*15-i*5);return e>=90?{grade:"A",label:"Excellent",color:"text-emerald-400",bg:"border-emerald-500/30"}:e>=75?{grade:"B",label:"Good",color:"text-green-400",bg:"border-green-500/30"}:e>=60?{grade:"C",label:"Fair",color:"text-yellow-400",bg:"border-yellow-500/30"}:e>=40?{grade:"D",label:"Poor",color:"text-orange-400",bg:"border-orange-500/30"}:{grade:"F",label:"Critical",color:"text-red-400",bg:"border-red-500/30"}}const h={critical:{bg:"bg-red-500/10",border:"border-red-500/20",badge:"bg-red-500/20 text-red-400",icon:"ðŸ”´"},warning:{bg:"bg-yellow-500/10",border:"border-yellow-500/20",badge:"bg-yellow-500/20 text-yellow-400",icon:"ðŸŸ¡"},info:{bg:"bg-blue-500/10",border:"border-blue-500/20",badge:"bg-blue-500/20 text-blue-400",icon:"ðŸ”µ"}};function f(t){const r=document.getElementById("results"),i=document.getElementById("findingsList");if(!t||t.length===0){document.getElementById("envInput").value.trim()?(r.classList.remove("hidden"),document.getElementById("scoreGrade").textContent="A",document.getElementById("scoreGrade").className="text-6xl font-black text-emerald-400",document.getElementById("scoreLabel").textContent="No issues found!",document.getElementById("scoreLabel").className="text-sm mt-1 text-emerald-400",document.getElementById("scoreCard").className="flex-shrink-0 w-full sm:w-48 rounded-lg border border-emerald-500/30 bg-gray-900 p-6 flex flex-col items-center justify-center",document.getElementById("critCount").textContent="0",document.getElementById("warnCount").textContent="0",document.getElementById("infoCount").textContent="0",i.innerHTML='<p class="text-gray-500 text-sm">âœ… No issues detected. Your .env file looks clean!</p>',document.getElementById("gitignoreSection").classList.remove("hidden")):r.classList.add("hidden");return}r.classList.remove("hidden");const e=x(t);document.getElementById("scoreGrade").textContent=e.grade,document.getElementById("scoreGrade").className=`text-6xl font-black ${e.color}`,document.getElementById("scoreLabel").textContent=e.label,document.getElementById("scoreLabel").className=`text-sm mt-1 ${e.color}`,document.getElementById("scoreCard").className=`flex-shrink-0 w-full sm:w-48 rounded-lg border ${e.bg} bg-gray-900 p-6 flex flex-col items-center justify-center`;const s=t.filter(a=>a.severity==="critical"),g=t.filter(a=>a.severity==="warning"),o=t.filter(a=>a.severity==="info");document.getElementById("critCount").textContent=s.length,document.getElementById("warnCount").textContent=g.length,document.getElementById("infoCount").textContent=o.length,i.innerHTML=[...s,...g,...o].map(a=>{const l=h[a.severity];return`<div class="rounded-lg ${l.bg} border ${l.border} p-4">
          <div class="flex items-start gap-3">
            <span class="text-sm mt-0.5">${l.icon}</span>
            <div class="flex-1 min-w-0">
              <div class="flex items-center gap-2 flex-wrap">
                <span class="text-sm font-medium text-gray-200">${a.name}</span>
                <span class="text-xs px-2 py-0.5 rounded-full ${l.badge}">${a.severity}</span>
                <span class="text-xs text-gray-500">Line ${a.line}</span>
              </div>
              <p class="text-sm text-gray-400 mt-1">${a.desc}</p>
              <p class="text-xs text-gray-500 mt-1">ðŸ’¡ ${a.fix}</p>
            </div>
          </div>
        </div>`}).join(""),document.getElementById("gitignoreSection").classList.remove("hidden")}document.getElementById("gitignoreSuggest").textContent=`.env
.env.local
.env.production
.env.*.local
.env.development.local
.env.test.local
.env.production.local`;const m=document.getElementById("envInput");let k;m.addEventListener("input",()=>{clearTimeout(k),k=setTimeout(()=>f(y(m.value)),150)});document.getElementById("sampleBtn").addEventListener("click",()=>{m.value=v,f(y(v))});document.getElementById("clearBtn").addEventListener("click",()=>{m.value="",document.getElementById("results").classList.add("hidden")});document.getElementById("copyBtn").addEventListener("click",()=>{const t=y(m.value);if(!t)return;const r=x(t),i=`ENV Validator Report â€” Score: ${r.grade} (${r.label})
Critical: ${t.filter(e=>e.severity==="critical").length} | Warnings: ${t.filter(e=>e.severity==="warning").length} | Info: ${t.filter(e=>e.severity==="info").length}

`+t.map(e=>`[${e.severity.toUpperCase()}] Line ${e.line}: ${e.name} â€” ${e.desc}`).join(`
`)+`

Scanned with halfday.dev/tools/env-validator`;navigator.clipboard.writeText(i).then(()=>{const e=document.getElementById("copyBtn");e.innerHTML='<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg> Copied!',setTimeout(()=>{e.innerHTML='<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg> Copy Results'},2e3)})});
